(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[1712],{9149:function(e,s,n){(window.__NEXT_P=window.__NEXT_P||[]).push(["/docs/resources/k8s/kubernetes_config",function(){return n(4040)}])},4040:function(e,s,n){"use strict";n.r(s),n.d(s,{__N_SSG:function(){return c}});var o=n(5893),t=n(1151),a=n(8691);function r(e){let s=Object.assign({h1:"h1",code:"code",p:"p",h2:"h2",pre:"pre"},(0,t.ah)(),e.components),{Intro:n,Properties:r,Property:c}=s;return n||l("Intro",!0),r||l("Properties",!0),c||l("Property",!0),(0,o.jsxs)(o.Fragment,{children:[(0,o.jsxs)(s.h1,{children:["Kubernetes Configuration ",(0,o.jsx)(s.code,{children:"k8s_config"})]}),"\n",(0,o.jsxs)(n,{children:[(0,o.jsxs)(s.p,{children:["The k8s_config resource allows Kubernetes configuraton to be applied to a\n",(0,o.jsx)(s.code,{children:"k8s_cluster"}),"."]}),(0,o.jsxs)(s.p,{children:["You can specify a list of paths or individual files and health checks for\nthe resources.  A ",(0,o.jsx)(s.code,{children:"k8s_config"})," only completes once the configuration has been\nsuccessfully applied and any health checks have passed. This allows you to\ncreate complex dependencies for your applications."]}),(0,o.jsxs)(s.p,{children:["Jumppad monitors changes to the config defined in the ",(0,o.jsx)(s.code,{children:"paths"})," property and\nautomatically recreates this resource when ",(0,o.jsx)(s.code,{children:"jumppad up"})," is called."]})]}),"\n",(0,o.jsx)(s.h2,{id:"properties",children:"Properties"}),"\n",(0,o.jsxs)(r,{children:[(0,o.jsxs)(c,{name:"cluster",type:"nomad_cluster",required:"true",value:"",children:[(0,o.jsx)(s.p,{children:"The reference to a cluster to apply the jobs to. Kubernetes config\nis only applied when the referenced cluster is created and healthy."}),(0,o.jsx)(s.pre,{language:"hcl",code:'  resource "nomad_job" "example" {\n    cluster = resource.nomad_cluster.dev\n    ...\n  }\n',children:(0,o.jsx)(s.code,{className:"language-hcl",children:'<span><span style="color: var(--shiki-color-text)">  </span><span style="color: var(--shiki-token-keyword)">resource</span><span style="color: var(--shiki-token-string-expression)"> &quot;nomad_job&quot; &quot;example&quot;</span><span style="color: var(--shiki-color-text)"> {</span></span>\n<span><span style="color: var(--shiki-color-text)">    cluster </span><span style="color: var(--shiki-token-keyword)">=</span><span style="color: var(--shiki-color-text)"> resource</span><span style="color: var(--shiki-token-constant)">.</span><span style="color: var(--shiki-color-text)">nomad_cluster</span><span style="color: var(--shiki-token-constant)">.</span><span style="color: var(--shiki-color-text)">dev</span></span>\n<span><span style="color: var(--shiki-color-text)">    ...</span></span>\n<span><span style="color: var(--shiki-color-text)">  }</span></span>\n<span></span>'})})]}),(0,o.jsx)(c,{name:"paths",type:"[]string",required:"true",value:"",children:(0,o.jsx)(s.p,{children:"Paths to the Nomad job files to apply to the cluster."})}),(0,o.jsx)(c,{name:"health_check",type:"#health_check",required:"false",value:"",children:(0,o.jsx)(s.p,{children:"Optional health check to perform after the jobs have been applied, this resource\nwill not complete until the health checks are passing."})}),(0,o.jsx)(c,{name:"wait_until_ready",type:"bool",required:"true",value:"",children:(0,o.jsx)(s.p,{children:"Determines if the resource waits until all config defined in the paths\nhas been accepted and started by the server. If set to false the resource\nreturns immediately after submitting the job."})})]}),"\n",(0,o.jsx)(s.h2,{id:"health_check",children:"health_check"}),"\n",(0,o.jsx)(s.p,{children:"A health_check stanza allows the definition of a health check which must\npass before the resource is marked as successfully created."}),"\n",(0,o.jsx)(s.pre,{language:"hcl",code:'health_check {\n  timeout = "60s"\n  pods = [\n    "component=server,app=consul", \n    "component=client,app=consul"\n  ]\n}\n',children:(0,o.jsx)(s.code,{className:"language-hcl",children:'<span><span style="color: var(--shiki-token-keyword)">health_check</span><span style="color: var(--shiki-color-text)"> {</span></span>\n<span><span style="color: var(--shiki-color-text)">  timeout </span><span style="color: var(--shiki-token-keyword)">=</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-string-expression)">&quot;60s&quot;</span></span>\n<span><span style="color: var(--shiki-color-text)">  pods </span><span style="color: var(--shiki-token-keyword)">=</span><span style="color: var(--shiki-color-text)"> [</span></span>\n<span><span style="color: var(--shiki-color-text)">    </span><span style="color: var(--shiki-token-string-expression)">&quot;component=server,app=consul&quot;</span><span style="color: var(--shiki-color-text)">, </span></span>\n<span><span style="color: var(--shiki-color-text)">    </span><span style="color: var(--shiki-token-string-expression)">&quot;component=client,app=consul&quot;</span></span>\n<span><span style="color: var(--shiki-color-text)">  ]</span></span>\n<span><span style="color: var(--shiki-color-text)">}</span></span>\n<span></span>'})}),"\n",(0,o.jsxs)(r,{children:[(0,o.jsx)(c,{name:"timeout",type:"duration",required:"true",value:"",children:(0,o.jsxs)(s.p,{children:["The maximum duration to wait before marking the health check as failed.\nExpressed as a Go duration, e.g. ",(0,o.jsx)(s.code,{children:"1s"})," = 1 second, ",(0,o.jsx)(s.code,{children:"100ms"})," = 100 milliseconds."]})}),(0,o.jsx)(c,{name:"pods",type:"[]string",required:"true",value:"",children:(0,o.jsx)(s.p,{children:"An array of kubernetes selector syntax. The healthcheck ensures that all\ncontainers defined by the selector are running before passing the healthcheck."})})]}),"\n",(0,o.jsx)(a.default,{}),"\n",(0,o.jsx)(s.h2,{id:"examples",children:"Examples"}),"\n",(0,o.jsx)(s.pre,{language:"hcl",code:'resource "k8s_config" "app" {\n  cluster = resource.k8s_cluster.k3s\n\n  paths = [\n    "./k8s_config/app",\n    "./k8s_config/dashboard",\n  ]\n\n  wait_until_ready = true\n}\n',children:(0,o.jsx)(s.code,{className:"language-hcl",children:'<span><span style="color: var(--shiki-token-keyword)">resource</span><span style="color: var(--shiki-token-string-expression)"> &quot;k8s_config&quot; &quot;app&quot;</span><span style="color: var(--shiki-color-text)"> {</span></span>\n<span><span style="color: var(--shiki-color-text)">  cluster </span><span style="color: var(--shiki-token-keyword)">=</span><span style="color: var(--shiki-color-text)"> resource</span><span style="color: var(--shiki-token-constant)">.</span><span style="color: var(--shiki-color-text)">k8s_cluster</span><span style="color: var(--shiki-token-constant)">.</span><span style="color: var(--shiki-color-text)">k3s</span></span>\n<span></span>\n<span><span style="color: var(--shiki-color-text)">  paths </span><span style="color: var(--shiki-token-keyword)">=</span><span style="color: var(--shiki-color-text)"> [</span></span>\n<span><span style="color: var(--shiki-color-text)">    </span><span style="color: var(--shiki-token-string-expression)">&quot;./k8s_config/app&quot;</span><span style="color: var(--shiki-color-text)">,</span></span>\n<span><span style="color: var(--shiki-color-text)">    </span><span style="color: var(--shiki-token-string-expression)">&quot;./k8s_config/dashboard&quot;</span><span style="color: var(--shiki-color-text)">,</span></span>\n<span><span style="color: var(--shiki-color-text)">  ]</span></span>\n<span></span>\n<span><span style="color: var(--shiki-color-text)">  wait_until_ready </span><span style="color: var(--shiki-token-keyword)">=</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-constant)">true</span></span>\n<span><span style="color: var(--shiki-color-text)">}</span></span>\n<span></span>'})})]})}var c=!0;function l(e,s){throw Error("Expected "+(s?"component":"object")+" `"+e+"` to be defined: you likely forgot to import, pass, or provide it.")}s.default=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},{wrapper:s}=Object.assign({},(0,t.ah)(),e.components);return s?(0,o.jsx)(s,Object.assign({},e,{children:(0,o.jsx)(r,e)})):r(e)}},8691:function(e,s,n){"use strict";n.r(s),n.d(s,{__N_SSG:function(){return r}});var o=n(5893),t=n(1151);function a(e){let s=Object.assign({h2:"h2",p:"p",code:"code",a:"a"},(0,t.ah)(),e.components);return(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(s.h2,{id:"meta_properties",children:"Meta Properties"}),"\n",(0,o.jsxs)(s.p,{children:["In addition to the main properties, all resources have meta properties, such\nas the ",(0,o.jsx)(s.code,{children:"id"})," of the resource. To see the list of these properties please see the\n",(0,o.jsx)(s.code,{children:"Meta Properties"})," section in the documentation ",(0,o.jsx)(s.a,{href:"/docs/resources/meta",children:"/docs/resources/meta"}),"."]})]})}var r=!0;s.default=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},{wrapper:s}=Object.assign({},(0,t.ah)(),e.components);return s?(0,o.jsx)(s,Object.assign({},e,{children:(0,o.jsx)(a,e)})):a(e)}}},function(e){e.O(0,[9774,2888,179],function(){return e(e.s=9149)}),_N_E=e.O()}]);